<% content_for :head do %>
<%= javascript_include_tag 'domain_templates.js' %>
<% end %>


<div class='scrollable'>
<div class='container'  id='domain_template_form_wrapper'>

    <h1>New domain template</h1>

    <div class="row-fluid">
    <div class="span7">
      <%= form_for :domain_template, :url => domain_templates_path do |f| %>

      <label>Template name</label>
      <%= f.text_field :name, :class=> 'input-large' %>
      
      <label>Intervals actions stack</label>
      
      <div class='well'>
      
      <ul class='ui-menu' id='domain-template-sortable'>
        <li class='fixed first' style='padding-bottom:5px;'><a class='btn' id='domain-template-add-action-btn'>Add action</a></a>
        <li class='fixed'><span class='uneditable-input' style='disply:block;'>Empty domain stack bottom.</span></li>
      </ul>
      </div>
      
      <div class="form-actions">
      <%= f.button 'Save', :class => 'btn btn-primary', 'data-domain-template' => 'save-btn' %>
      </div>
      
      <% end %>
    </div>
    <div class="span5 well">
    
      <div id='domain-template-add-action' style='display:none'>
      <p><%= select_tag :action, options_for_select([['-- Select action --', '0'],['Add', 'add'],['Remove', 'remove'],['Mask', 'mask']]), :id => 'domain-template-add-action-kind' %></p>
      <div>
      <%= select_tag :type, options_for_select([['-- New interval --', '0'],['Boundless infinity', 'boundless'],['Bounded', 'bounded'],['-- Defined: --', '-', {:disabled => true}]] + (@domain_templates.map {|t| [t.name, t.id]})), :id => 'domain-template-add-type' %>    
      </div>
      
      <div id='bounded-domain-form' data-domain-form='bounded' style="display:none" >
      <%= form_for '', :url =>'#' do |f| %>
        <div>
          <p>From</p> <%= f.datetime_select :from,:html_options=>{:class=>'input-small'} %>
        </div>
        <div>
          <p>To</p> <%= f.datetime_select :to, :html_options=>{:class=>'input-small'} %>
        </div>
      <% end %>
      </div>
      <div id='boundless-domain-form' data-domain-form='boundless' style="display:none" >
        <%= form_for '', :url=> '#' do |f| %>
          <div>
          <p>Repeat interval starting at</p> <%= f.datetime_select :from, :html_options=>{:class=>'input-small'} %>
          </div>
          <%= f.fields_for :duration do |f| %>
          <div>
          <p>lasting</p> <%= f.text_field :duration %> <%= f.select :unit, options_from_collection_for_select(Duration.units, :first, :last) %>
          </div>
          <% end %>
          <%= f.fields_for :period do |f| %>
          <div>
          <p>each</p> <%= f.text_field :duration %> <%= f.select :unit, options_from_collection_for_select(Duration.units, :first, :last) %>
          </div>
          <% end %>
         
        <% end %>
      </div>
      
      <p>
      <%= link_to 'Add', '#', :class => 'btn', :id=> 'domain-template-add-action-submit-btn' %>    
      </p>
      </div>
    </div>
  </div>
    

</div></div>

